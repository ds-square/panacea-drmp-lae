
package org.panacea.drmp.lae.domain.vulnerability.network;

import lombok.Data;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

@Data
@SuppressWarnings("unused")
public class VulnerabilityCatalog {

    private String environment;
    private String fileType;
    private String snapshotId;
    private String snapshotTime;
    private List<Vulnerability> vulnerabilities;

    private Map<String, Vulnerability> vulnerabilityMap;

    public VulnerabilityCatalog() {
        this.vulnerabilities = new ArrayList<>();
        this.vulnerabilityMap = new HashMap<>();
    }

    public void computeHumanVulnerabilityMap() {
        for (Vulnerability v : this.getVulnerabilities()) {
            this.vulnerabilityMap.put(v.getCveId(), v);
        }
    }

    public Vulnerability getVulnerabilityById(String id) {
        return this.vulnerabilityMap.get(id);
    }
}
